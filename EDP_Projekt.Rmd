---
title: "Zastosowanie metod ekonometrycznych na danych panelowych"
author: "Jakub Sornat, Maciej Tajs"
date: "2025-01-23"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: flatly
    code_folding: hide
    warning: false
    message: false
---

# Wstęp

Celem niniejszej pracy jest przeprowadzenie analizy danych panelowych w celu oszacowania zależności między zmiennymi objaśniającymi a zmienną objaśnianą, z uwzględnieniem efektów czasowych oraz indywidualnych poprzez estymację modeli ekonometrycznych oraz ich interpretację. Praca będzie składała się z następujących elementów:

1. **Opis danych**: W pierwszej części pracy przedstawione zostaną dane użyte w analizie, w tym zmienne, ich jednostki miary, oraz zakres czasowy. Zostanie również wskazana zmienna objaśniana oraz omówienie oczekiwanych zależności między zmiennymi.

2. **Estymacja modeli ekonometrycznych**: W tej części pracy zostaną oszacowane modele ekonometryczne na podstawie danych panelowych, uwzględniając zarówno efekty czasowe, jak i indywidualne. Zostaną porównane różne modele (np. efekty stałe vs efekty losowe), a wybór najlepszego modelu będzie uzasadniony za pomocą odpowiednich testów i procedur estymacyjnych.

3. **Diagnostyka modelu**: Zostaną przeprowadzone testy diagnostyczne w celu oceny jakości oszacowanych modeli, takie jak testy heteroskedastyczności, autokorelacji czy endogeniczności zmiennych objaśniających. W przypadku wystąpienia problemów diagnostycznych, podjęte zostaną próby ich rozwiązania lub omówienie wpływu tych problemów na interpretację wyników.

4. **Interpretacja wyników**: W tej sekcji przedstawione zostaną wyniki oszacowanych modeli oraz ich interpretacja. Zostanie szczegółowo omówione, jak poszczególne zmienne objaśniające wpływają na zmienną objaśnianą, oraz jakie są efekty czasowe i indywidualne w badanym modelu.

## Zmienne użyte w pracy

Badanie dotyczy 16 województw Polski w okresie od 2018 roku do 2022 roku. Oznacza to, że wykorzystane dane panelowe będą postaci 16 jednostek przekroju w 5 okresach. Zbiór danych został utworzony na podstawie danych zawartych w Banku Danych Lokalnych Głównego Urzędu Statystycznego (BDL GUS). Początkowo wstępny zbiór danych zawiera 13 zmiennych objaśniających oraz 1 zmienną objaśnianą. Poniżej opisano zbiór danych:

### Zmienna endogeniczna (objaśniana):
- **malzenstwa_wskaznik** –  Stosunek liczby małżeństw zawartych w danym roku do 10 tys. ludności

### Zmienne egzogeniczne (objaśniające):
- **saldo_migracji** – wskaźnik salda migracji w danym województwie na 10 tys. ludności
- **zywnosc** – wskaźnik cen dla żywności i napoi bezalkoholowych
- **rozwody** – wskaźnik rozwodów (nie wliczając separacji) ogółem na 10 tys. ludności
- **urodzenia_zywe** – wskaźnik urodzeń żywych na 10 tys. ludności
- **bezrobocie** – stopa bezrobocia
- **cena_metr_kw** – kwota za 1 m² mieszkania
- **przedszkole** – liczba przedszkoli na 10 tys. ludności
- **wynagrodzenie** – przeciętne miesięczne wynagrodzenie brutto
- **mieszkania_oddane** – mieszkania oddane do użytkowania na 1000 ludności
- **kwota_swiad_rodz** – kwoty świadczeń rodzinnych wypłaconych w roku przypadająca na 1000 mieszkańców
- **urodzenia_pozamalzenskie** – wskaźnik urodzeń żywych pozamałżeńskich na 1000 ludności
- **absolwenci_na_10000** – liczba absolwentów, którzy ukończyli studia w danym roku w przeliczeniu na 10 tys. ludności
- **srednia_cena_mieszk** – średnia cena mieszkań w danym roku w danym województwie

# Analiza danych

## Import niezbędnych bibliotek
W celu przeprowadzenia analizy danych oraz oszacowania modeli ekonometrycznych, niezbędne okazały się biblioteki w języku R, które zapewniają dostęp do funkcji ułatwiających przetwarzanie danych, estymację modeli oraz wizualizację wyników.

```{r message=FALSE, warning=FALSE}
library(readxl)
library(psych)
library(corrplot)
library(dplyr)
library(DT)
library(ggplot2)
library(reshape2)
library(tidyr)
library(gridExtra)
library(plm)
```

## Budowa przydatnych funckji

Do badania przydate okazały się również funckję które na wstępnym etapie opracowano samodzielenie.

```{r}
coefficient_of_variation <- function(x) {
  if (mean(x, na.rm = TRUE) == 0) {
    return("NA%") # Unikamy dzielenia przez zero
  }
  cv <- (sd(x, na.rm = TRUE) / mean(x, na.rm = TRUE)) * 100
  cv_rounded <- round(cv, 2) # Zaokrąglanie do dwóch miejsc
  return(cv_rounded) # Dodanie znaku %
}
```

## Prezentacja danych

Tabela poniżej przedstawia dane użete w badaniu.

```{r}
data <- as.data.frame(read_excel("Projekt_EDP_dane.xlsx"))

# Wyświetlenie tabeli interaktywnej z przewijaniem
datatable(data, options = list(pageLength = 10, scrollX = TRUE, scrollY = 400))
```

## Statystyki opisowe

Zdecydowano się na oszacowanie statystyk opisowych, które okazały się pomocne we wstępnej analizie danych. Miary takie jak **liczba obserwacju**, **średnia**, **mediana**, **odchylenie standardowe**, **minimum**, **maksimum**, **pierwszy**, **trzeci kwartyl**, **wartość skośności** oraz **wartość kurtozy** mogą wnieść wiele cennych informacji na temat rozkładu i charakterystyki poszczególnych zmiennych.

```{r}
numeric_data <- data %>%
  select(-rok, -wojewodztwo, -woj_nr)

# Wyświetlenie statystyk opisowych tylko dla danych numerycznych
summary_stats <- describe(numeric_data)

# Zaokrąglanie wyników do 2 miejsc po przecinku
summary_stats_rounded <- summary_stats %>%
  mutate(across(where(is.numeric), ~ round(.x, 2)))

# Wyświetlenie tabeli w formie interaktywnej
datatable(summary_stats_rounded, options = list(pageLength = 10, scrollX = TRUE, scrollY = 400))

```

Na podstawie statystyk opisowych możemy wyciągnąć następujące wnioski i obserwacje dotyczące danych:

- **Wartość średnia zmiennej `malzenstwa_wskaznik` wynosi 4.63, ale odchylenie standardowe (0.47) jest stosunkowo niewielkie**. Oznacza to, że wskaźnik małżeństw w różnych województwach jest dość stabilny, z niewielkimi różnicami w porównaniu do średniej. Regiony o wyższych wskaźnikach małżeństw mogą cechować się tradycyjnymi wartościami rodzinnymi i społecznymi, podczas gdy w województwach z niższymi wartościami tego wskaźnika, może występować większa otwartość na inne formy życia rodzinnego lub większe trudności związane z decyzją o zawarciu małżeństwa, np. z powodu problemów finansowych.

- **Duża zmienność w zmiennej `saldo_migracji`:** Zmienna ta pokazuje dużą różnicę między wartościami minimalnymi (-33.57) i maksymalnymi (30.91). Regiony o wysokim saldzie migracji mogą charakteryzować się napływem nowych mieszkańców, co może wpływać na większą liczbę małżeństw. Z kolei w województwach z negatywnym saldem migracji, emigracja może prowadzić do spadku liczby zawieranych małżeństw, gdyż osoby wyjeżdżające mogą nie zakładać rodzin w miejscu, z którego pochodzą.

- **Zmienna `zywnosc` wskazuje na stabilność w poziomie wydatków na żywność:** Średnia wynosi 26.13, a odchylenie standardowe 2.4, co sugeruje, że wydatki na żywność są stosunkowo jednorodne w różnych województwach. Wysokie wartości tej zmiennej mogą wskazywać na regiony, w których standard życia jest wyższy, a rodziny mogą być bardziej stabilne finansowo, co sprzyja decyzjom o zawieraniu małżeństw. W regionach, w których wydatki na żywność są niższe, mogłyby występować trudności finansowe, które wpływają na decyzję o małżeństwie.

- **Wysoka zmienność w liczbie `rozwody`:** Zmienna ta ma średnią wartość 16.07 i odchylenie standardowe 2.63, co sugeruje, że liczba rozwodów w różnych województwach jest zróżnicowana. Regiony z wyższą liczbą rozwodów mogą wskazywać na mniejsze stabilności małżeństw lub na społeczne i ekonomiczne czynniki, które wpływają na większe trudności w utrzymaniu małżeństw. Może to mieć związek z warunkami finansowymi, w których pary mogą decydować się na rozstanie.

- **Różnice w wynagrodzeniach w województwach:** Zmienna `wynagrodzenie` wskazuje na duże zróżnicowanie w zarobkach, od 2836 do 8194 zł, z średnią wynoszącą 4393.97 zł i odchyleniem standardowym 1039.67. Wysokie wynagrodzenia mogą wpływać na większą stabilność finansową par, co może prowadzić do wyższej liczby zawieranych małżeństw w województwach o wyższych dochodach. Natomiast w regionach z niższymi wynagrodzeniami, młodsze pokolenia mogą wstrzymywać decyzję o małżeństwie z powodu braku poczucia stabilności finansowej.

- **Zmienność w liczbie `przedszkole`:** Zmienna ta wskazuje, że w województwach liczba przedszkoli na 10 tys. ludności waha się od 1.17 do 6.84, co może świadczyć o zróżnicowanym dostępie do edukacji przedszkolnej. Regiony z wyższą liczbą przedszkoli mogą oferować lepsze warunki do wychowywania dzieci, co może skłaniać pary do zakładania rodzin i zawierania małżeństw. Z kolei województwa z mniejszą liczbą przedszkoli mogą mieć ograniczony dostęp do usług opiekuńczych, co może wpływać na decyzje o posiadaniu dzieci i zawieraniu małżeństw.




## Brakujące dane w zbiorze

Zbadano również wsytępowanie braków danych w zbiorze.

```{r}
# Liczba brakujących wartości w każdej kolumnie
missing_per_column <- colSums(is.na(data))
print(missing_per_column)
```

Wyniki pokazuja, że zestaw nie zawiera braków danych.


## Współczynnik zmienności

Obliczono współczynnik zmienności. Zdecycowane, że zmienne któtych wartość będzie niższa od 10 % będą wykluczone z badania z podobu zbyt niskiej wartości infarmacyjnej.

```{r}
# Obliczanie współczynnika zmienności dla każdej kolumny numerycznej
cv_per_column <- numeric_data %>%
  summarise(across(everything(), ~ coefficient_of_variation(.x))) %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "CV")

# Wyświetlenie wyników
print(cv_per_column)
```

Wartość współczynnika dla zmiennej zywnosc wynosi 9.17%. Jest to niewystaraczający wynik dlatego zdecydowano się wykluczyć ją z badania. Ta sama sytuacja będzie miała miejsce w przypadku zmiennej malzenstwa_wskaznik

```{r}
numeric_data <- numeric_data %>% select(-zywnosc)
```

## Macierz korelacji pomiędzy zmiennymi

Poniższy wykres przedstawia macierz korelacji pomiędzy zmiennymi.

```{r}

# Obliczanie macierzy korelacji
cor_matrix <- cor(numeric_data, use = "complete.obs")

# Przekształcanie macierzy korelacji na format długowy (melt)
cor_matrix_melted <- melt(cor_matrix)

# Wizualizacja z ggplot2, zmniejszenie rozmiaru czcionki
ggplot(cor_matrix_melted, aes(Var1, Var2, fill = value)) +
  geom_tile() +  # Tworzenie kafelków
  scale_fill_gradient2(low = "blue", high = "red", mid = "white", midpoint = 0) +  # Kolory
  geom_text(aes(label = round(value, 2)), color = "black", size = 3, fontface = "bold") +  # Zmniejszenie czcionki
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  # Obrót etykiet osi X
  labs(title = "Macierz Korelacji", fill = "Korelacja")  # Dodanie tytułu i legendy
```

Ze względu na bardzo niską korelację ze zmienną objaśnianą (malzenstwa_wskaznik) zdecydowano się na usunięcie dwóch zmiennych: mieszkania_oddane oraz urodzenia_pozamalzenskie. Dodatkowo ze względu na wysoką wzajemną zaleść usunięto zmienną przedszkole oraz bezrobocie oraz cena_metr_kw

```{r}
numeric_data <- numeric_data %>% 
  select(-mieszkania_oddane, -urodzenia_pozamalzenskie, -przedszkole, -bezrobocie, -cena_metr_kw)

data <- data %>%
  select(-mieszkania_oddane, -urodzenia_pozamalzenskie, -przedszkole, -bezrobocie, -cena_metr_kw)
```


# Estymacja modeli

Do dalszej analizy niezbędnym jest przekształcenie danych do formatu panelowego.

```{r}
panel_data <- pdata.frame(data, index = c("wojewodztwo", "rok"))

```

Następnie definiujemy zmienne egzogeniczne naszego modelu

```{r}
# Zmienne objaśniające
zmienne <- c("saldo_migracji", "rozwody", "urodzenia_zywe", 
             "wynagrodzenie", "kwota_swiad_rodz", "absolwenci_na_10000", 
             "srednia_cena_mieszk")

# Formuła modelu
form <- as.formula(paste("malzenstwa_wskaznik ~", paste(zmienne, collapse = " + ")))
```

## Model regresji łącznej

Model regresji łącznej (ang. pooled regression model) jest jednym z podstawowych podejść w analizie danych panelowych, w którym zakłada się, że nie ma różnic między jednostkami (np. krajami, województwami, firmami) ani między okresami czasowymi, tzn. traktuje się dane jako jednorodne. Oznacza to, że wszystkie jednostki i okresy są „połączone” (ang. pooled) w jeden duży zbiór danych, a zmienne objaśniające mają jednorodny wpływ na zmienną objaśnianą. Oznacza to, że nie uwzględnia się specyficznych cech jednostek (np. województw) ani specyficznych trendów czasowych. 

### Pretestowanie
Przed przystąpieniem do estymacji należy przeprowadzić test Chowa na stabilność parametrów. 

Hipoteza zerowa: parametry strukturalne są stałe w analizowanej próbie, czyli 
takie same dla wszystkich jednostek i we wszystkich okresach (inaczej: można 
stosować regresję łączną).

```{r}
# Model regresji łącznej
model_pool <- plm(form, data = panel_data, model = "pooling")

# Podsumowanie wyników
summary(model_pool)
```

Oceniając jakość modelu regresji łącznej (Pooling Model), uwzględniamy kilka kluczowych wskaźników, które pozwalają ocenić, jak dobrze model tłumaczy zmienność zmiennej objaśnianej oraz jak istotne są poszczególne zmienne objaśniające.


1. **Współczynnik determinacji (R-squared)**:  
   Wartość R-squared wynosząca 0.45139 sugeruje, że model wyjaśnia około 45% zmienności zmiennej objaśnianej, czyli wskaźnika małżeństw. Jest to umiarkowana wartość, wskazująca na to, że model częściowo dopasowuje się do danych. Wartość ta sugeruje, że zmienne objaśniające w modelu mają pewien wpływ na zmienną zależną, ale nadal pozostaje sporo zmienności niewytłumaczonej.

2. **Skorygowany współczynnik determinacji (Adjusted R-squared)**:  
   Skorygowany R-squared wynoszący 0.42612 wskazuje na dobrą jakość modelu, uwzględniając liczbę zmiennych objaśniających. Ta wartość sugeruje, że model jest dobrze dopasowany i nie zawiera zbędnych zmiennych, które mogłyby pogorszyć jakość dopasowania.

3. **Test F**:  
   Test F sprawdza, czy model jako całość jest statystycznie istotny. Uzyskana wartość statystyki F wynosząca 17.866, z p-wartością < 2.22e-16, wskazuje na to, że model jest statystycznie istotny, czyli zmienne objaśniające w sposób istotny wpływają na zmienną zależną.

4. **Wartości p zmiennych objaśniających**:  
   - **Zmienne istotne statystycznie**: Zmienne takie jak „rozwody” (p = 0.044), „wynagrodzenie” (p = 0.0004111), „absolwenci_na_10000” (p = 0.0049277) są istotne na poziomie 0.05, co oznacza, że mają znaczący wpływ na zmienną zależną.  
   - **Zmienne nieistotne statystycznie**: Z kolei zmienne takie jak „saldo_migracji” (p = 0.1257), „urodzenia_zywe” (p = 0.235), „kwota_swiad_rodz” (p = 0.4085), oraz „srednia_cena_mieszk” (p = 0.6407) mają p-wartości większe niż 0.05, co sugeruje, że nie mają one istotnego wpływu na zmienną zależną w tym modelu.

5. **Rozkład reszt**:  
   Rozkład reszt wskazuje, że model nie wykazuje istotnych błędów systematycznych. Minimum reszt wynosi -1.016358, a maksimum 0.769498, co sugeruje, że błędy prognoz są rozłożone równomiernie wokół zera. Dodatkowo, wartość mediany reszt wynosząca 0.038826 świadczy o braku dużych odchyleń od wartości przewidywanych.


## Jednokierunkowy model z efektami ustalonymi

Model regresji z efektami ustalonymi (ang. fixed effects model) zakłada się, że różnice pomiędzy jednostkami (np. krajami, województwami, firmami) są istotne i należy je uwzględnić w modelu. Model ten pozwala na kontrolowanie indywidualnych cech jednostek, które nie zmieniają się w czasie, a które mogą wpływać na zmienną objaśnianą. Dzięki temu, efekt ustalony pozwala na oddzielenie wpływu zmiennych objaśniających od wpływu specyficznych cech jednostek, które mogą stanowić istotne źródło zmienności.

```{r}
# Model efektów ustalonych
model_fe <- plm(form, data = panel_data, model = "within")

# Podsumowanie wyników
summary(model_fe)
```
Miary dla jednokierunkowego modelu z efektami ustalonymi:
1. **Współczynnik determinacji (R-squared)**:
   - R-squared wynoszące **0.7032** sugeruje, że model wyjaśnia około 70% zmienności zmiennej zależnej, czyli wskaźnika małżeństw. Jest to stosunkowo dobra wartość, co wskazuje, że model dobrze dopasowuje się do danych, uwzględniając efekty jednostkowe.

2. **Skorygowany współczynnik determinacji (Adjusted R-squared)**:
   - Skorygowany R-squared wynoszący **0.65554** oznacza, że model jest nadal dobrze dopasowany, ale uwzględnia on liczbę zmiennych objaśniających. Wartość ta sugeruje, że dodanie zmiennych objaśniających nie wpłynęło negatywnie na jakość dopasowania.

3. **Test F**:
   - Test F z wartością statystyki **46.3702** i p-wartością **< 2.22e-16** wskazuje, że model jako całość jest statystycznie istotny. Oznacza to, że zmienne objaśniające mają istotny wpływ na zmienną zależną (wskaźnik małżeństw).

4. **Wartości p zmiennych objaśniających**:
   - **"rozwody"**: Wartość p **1.518e-09** jest znacznie mniejsza niż 0.05, co oznacza, że zmienna ta jest statystycznie istotna. Wzrost liczby rozwodów ma istotny wpływ na wzrost wskaźnika małżeństw.
   - **"urodzenia_zywe"**: Wartość p **9.751e-06** również wskazuje na statystyczną istotność tej zmiennej. Wzrost liczby urodzeń ma znaczący wpływ na spadek wskaźnika małżeństw.
   - **"wynagrodzenie"**: Wartość p **0.04589** jest mniejsza niż 0.05, co oznacza, że wynagrodzenia mają wpływ na wskaźnik małżeństw, ale jest to mniej wyraźne niż w przypadku poprzednich zmiennych.
   - **"kwota_swiad_rodz"**, **"absolwenci_na_10000"**: Wartości p są większe niż 0.05, co oznacza, że te zmienne nie mają statystycznie istotnego wpływu na zmienną zależną.
   - **"srednia_cena_mieszk"**: Zmienna ta ma wartość p **1.011e-06**, co wskazuje na jej silną statystyczną istotność. Wyższa cena mieszkań ma znaczący wpływ na spadek wskaźnika małżeństw.

5. **Rozkład reszt**:
   - Rozkład reszt jest stosunkowo równomierny, z wartością minimum **-0.811186** oraz maksimum **0.596663**, co sugeruje, że model dobrze odwzorowuje dane, a błędy są rozłożone wokół zera.
   - Mediana reszt wynosząca **0.035905** wskazuje na małe odchylenia od wartości przewidywanych.
   

## Dwukierunkowy model z efektami ustalonymi

Dwukierunkowy model z efektami ustalonymi (ang. **Two-way Fixed Effects Model**) to rozszerzenie modelu efektów ustalonych, który pozwala na uwzględnienie dwóch typów efektów stałych w analizie panelowej: efektów jednostkowych oraz efektów czasowych. Model dwukierunkowy zakłada, że każda jednostka może mieć swój specyficzny efekt, który pozostaje stały w czasie, a także każdy okres może mieć efekt, który jest wspólny dla wszystkich jednostek. Model uwzględnia te dwa typy efektów poprzez usunięcie zarówno efektów jednostkowych, jak i czasowych, z danych. Dzięki temu, analizując wpływ zmiennych objaśniających na zmienną zależną, można wyeliminować zarówno indywidualne cechy jednostek, jak i zmiany, które są wspólne dla wszystkich jednostek w danym czasie.

```{r}
# Model efektów ustalonych dwukierunkowy
model_fe_tw <- plm(form, data = panel_data, model = "within", effect = "twoways")

# Podsumowanie wyników
summary(model_fe_tw)
```
Model z efektami dwukierunkowymi (twoways effects) ma R-squared na poziomie 0.3674, co sugeruje umiarkowane dopasowanie. Wynagrodzenie jest istotnym czynnikiem (p-value < 0.001), a inne zmienne, takie jak saldo_migracji i rozwody, mają wartości p-bliskie granicy istotności (p < 0.1), ale nie są statystycznie istotne. R-squared skorygowane (0.2142) jest niskie, co sugeruje, że model ma ograniczoną zdolność wyjaśniania zmienności danych.


## Jednokierunkowy model z efektami losowymi

Model regresji z efektami losowymi (ang. random effects model) jest kolejnym podejściem w analizie danych panelowych, które zakłada, że różnice między jednostkami  są losowe i niezależne od zmiennych objaśniających. Oznacza to, że różnice między jednostkami traktowane są jako część składnika losowego, który jest zdefiniowany przez rozkład probabilistyczny.

W przeciwieństwie do modelu z efektami ustalonymi, model z efektami losowymi nie zakłada, że różnice między jednostkami są związane z ich indywidualnymi cechami, ale raczej traktuje je jako losowy składnik w procesie generowania danych. W związku z tym model z efektami losowymi jest bardziej odpowiedni w przypadku, gdy jednostki są traktowane jako losowe próby z populacji, a efekty jednostkowe nie są skorelowane z zmiennymi objaśniającymi.

```{r}
model_re <- plm(form, data = panel_data, model = "random")
summary(model_re)
```

Wyniki modelu efektów losowych (Random Effect Model) wskazują na następujące kluczowe obserwacje:

- zmienność wewnątrz jednostek ma dominujący wpływ (około 82,5% całkowitej zmienności).
- efekt indywidualny (różnice między jednostkami) stanowi tylko 17,5% zmienności.
Istotne zmienne:
- Rozwody (p = 0.0001), wynagrodzenie (p = 0.0403) oraz absolwenci na 10000 (p = 0.0059) mają istotny wpływ na zmienną zależną.
- Saldo migracji (p = 0.936), urodzenia żywe (p = 0.204), kwota świadczeń rodzinnych (p = 0.389) i średnia cena mieszkań (p = 0.240) nie są istotnymi zmiennymi.
Dopasowanie modelu:
- R-squared = 0.4996, co wskazuje na średnie dopasowanie modelu do danych.
Statystyka chi-kwadrat wynosi 151.765 (p < 2.22e-16), co sugeruje, że model jest istotny statystycznie.


## Dwukierunkowy model z efektami losowymi

Dwukierunkowy model z efektami losowymi (ang. Two-Way Random Effects Model) jest rozszerzeniem klasycznego modelu z efektami losowymi, w którym uwzględnia się dwie grupy efektów:

- Efekty indywidualne: Zmienność związana z jednostkami w panelu danych, na przykład z różnicami pomiędzy poszczególnymi obiektami.
- Efekty czasowe: Zmienność związana z upływem czasu, która może wpływać na wszystkie jednostki w tym samym czasie.

Model dwukierunkowy z efektami losowymi zakłada, że zarówno efekty indywidualne, jak i czasowe są losowe i niezależne od pozostałych zmiennych w modelu. W tym przypadku wykorzystywana jest transformacja Swamy-Arora, która pozwala na wyodrębnienie i oszacowanie tych efektów w panelu danych.

```{r}
# Model efektów ustalonych dwukierunkowy
model_fe_tw <- plm(form, data = panel_data, model = "random", effect = "twoways")

# Podsumowanie wyników
summary(model_fe_tw)
```

Wyniki przedstawiają model efektów losowych typu „two-way” (dwukierunkowy), z zastosowaniem transformacji Swamy-Arora. Model ten uwzględnia zarówno efekty indywidualne (zmienne specyficzne dla jednostek) oraz efekty czasowe.

**Kluczowe wyniki:**

- Efekty losowe (Random Effects):
- Efekt indywidualny (individual): 0.019198 (std. dev. = 0.138556), co wskazuje na zmienność wśród jednostek.
- Efekt czasowy (time): 0.040739 (std. dev. = 0.201840), co sugeruje istotną zmienność w czasie.
- Efekt idiosynkratyczny (idiosyncratic): 0.009852 (std. dev. = 0.099256), który odzwierciedla losową zmienność niezwiązaną z jednostkami i czasem.
- Współczynniki theta dla efektów są odpowiednio 0.7791 (id), 0.878 (czas) i 0.7645 (całkowity).
Współczynniki regresji:

- Saldo migracji ma istotny wpływ na zmienną zależną (estymacja = -0.006635, p-value = 0.002201).
- Kwota świadczeń rodzinnych (kwota_swiad_rodz) również ma istotny wpływ (estymacja = -0.00016132, p-value = 0.016054).
- Średnia cena mieszkania (srednia_cena_mieszk) jest na granicy istotności (p-value = 0.096019).
- Pozostałe zmienne, takie jak rozwody, wynagrodzenia, urodzenia żywe czy absolwenci na 10000, nie mają istotnego wpływu, ponieważ ich p-wartości są wyższe niż 0.05.
- Dopasowanie modelu:

R-squared = 0.1623, co sugeruje, że model wyjaśnia tylko 16,23% zmienności w danych.
Adj. R-squared = 0.1237, co uwzględnia liczbę zmiennych objaśniających.
Statystyka Chi-squared = 29.45 z p-wartością 0.00011974 wskazuje na istotność modelu.

# Wybór modelu

## Jednokierunkowy czy dwukierunkowy model z efektami utalonymi?

## Jednokierunkowy czy dwukierunkowy model z efektami losowymi

